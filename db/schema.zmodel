// Base types and models must come first
import "./shared.zmodel"

// Then auth
import "./auth.zmodel"

// Then the rest...
import "./client.zmodel"
import "./patrol.zmodel"
import "./workspace.zmodel"

import "./object-storage-file.zmodel"
import "./incident.zmodel"

// Development models
import "./seed-execution.zmodel"

import "./audit-log.zmodel"
import "./auth-session.zmodel"
import "./oauth-account.zmodel"
import "./user.zmodel"
import "./verification-token.zmodel"

// Add datasource configuration at the top
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["auth", "workspace", "development", "storage"]
}

// Add Prisma generator
generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
  previewFeatures = ["multiSchema"]
}

// https://github.com/onozaty/prisma-db-comments-generator
generator dbComments {
  provider = "prisma-db-comments-generator"
}

plugin zenstackPrisma {
  provider = '@core/prisma'
  output = '../prisma/schema.prisma'
  format = true
}

plugin zenstackHooks {
  provider = '@zenstackhq/tanstack-query'
  target = 'react'
  version = 'v5'
  output = "../lib/zenstack/hooks"
}

plugin trpc {
  provider = '@zenstackhq/trpc'
  output = '../lib/zenstack/trpc'
  generateClientHelpers = 'next'
  version = 'v11'
  importCreateRouter = "../lib/zenstack/trpc"
  importProcedure = "../lib/zenstack/trpc"
  zodSchemasImport = '../lib/schemas'
}

plugin zenstackZod {
  provider = '@core/zod'
  compile = true
  output = '../lib/schemas'
}

plugin zenstackEnhancer {
  provider = '@core/enhancer'
} 

// Development schema
// generator jsFrontend {
//   provider = "prisma-frontend"
// }

// // https://github.com/luisrudge/prisma-generator-fake-data
// generator fakeData {
//   provider = "prisma-generator-fake-data"
//   output   = "../types/fake-data.ts"
// }

// https://github.com/aravindanve/prisma-grapher?tab=readme-ov-file
generator erdDiagram {
  provider              = "prisma-grapher"
  output                = "../prisma/docs/ERD.svg"
  disabled              = false
  ignoreEnums           = false
  title                 = "PatrolSix Schema"
  lineColor             = "#004cff"
  headerBackgroundColor = "#bacefc"
  headerForegroundColor = "black"
  bodyBackgroundColor   = "white"
  bodyBackgroundColor2  = "#e8efff"
  bodyForegroundColor   = "black"
  typeForegroundColor   = "#4f83ff"
}

// plugin zenstackMarkdown {
//   provider = 'zenstack-markdown'
//   output = '../prisma/docs/schema.md'
//   disabled = false
//   // OPENAI_API_KEY
//   // ANTHROPIC_API_KEY
//   // XAI_API_KEY
// }